<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Manage Users</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/manage_user.css') }}">
    <script src="{{ url_for('static', filename='js/manage_user.js') }}" defer></script>
</head>

<body>

<div class="sidebar">
    <div class="logo-container">
        <img src="https://companieslogo.com/img/orig/NMDC.NS-b66af539.png" alt="NMDC Logo" class="logo">
        <h2>Admin</h2>
    </div>
    <ul class="menu">
        <li><a href="{{ url_for('admin_dashboard') }}"><i class="fa-solid fa-list"></i> Report</a></li>
        <li><a href="{{ url_for('manage_user') }}" class="active"><i class="fa-solid fa-users"></i> Manage Users</a></li>
        <li><a href="{{ url_for('manage_training') }}"><i class="fa-solid fa-chalkboard-user"></i> Manage Training</a></li>
        <li><a href="#" id="downloadBtn"><i class="fa-solid fa-download"></i> Download</a></li>
        <li><a href="{{ url_for('logout') }}"><i class="fa-solid fa-right-from-bracket"></i> Logout</a></li>
    </ul>
</div>

<div class="main-content">
    <header>
        <h1>Manage Users</h1>
        <span class="welcome">Welcome, {{ user }}</span>
    </header>

    <!-- Search + Edit/Save Navbar -->
    <div class="navbar-actions">
        <form method="GET" action="{{ url_for('manage_user') }}" class="search-form">
            <select name="filter_type" id="filterType">
                <option value="">-- Select Filter --</option>
                <option value="username" {% if request.args.get('filter_type') == 'username' %}selected{% endif %}>Username</option>
                <option value="role" {% if request.args.get('filter_type') == 'role' %}selected{% endif %}>Role</option>
            </select>

            <!-- Search Input -->
<input type="text" id="searchInput" name="search_value" placeholder="Enter search value"
       value="{{ request.args.get('search_value', '') }}" 
       {% if request.args.get('filter_type') == 'role' %}style="display:none;"{% endif %}>

<!-- Role Dropdown -->
<select id="roleDropdown" name="search_value"
        {% if request.args.get('filter_type') != 'role' %}style="display:none;"{% endif %}>
    <option value="">-- Select Role --</option>
    <option value="admin" {% if request.args.get('search_value') == 'admin' %}selected{% endif %}>Admin</option>
    <option value="reviewer_one" {% if request.args.get('search_value') == 'reviewer_one' %}selected{% endif %}>Reviewer One</option>
    <option value="reviewer_two" {% if request.args.get('search_value') == 'reviewer_two' %}selected{% endif %}>Reviewer Two</option>
</select>


            <button type="submit">Search</button>
        </form>

        <div class="edit-save-buttons">
            <button id="editBtn" class="edit-btn">Edit</button>
            <button id="saveBtn" class="save-btn" disabled>Save</button>
        </div>
    </div>

    <!-- Table -->
    <div id="results">
        {% if users %}
        <table id="usersTable">
            <thead>
                <tr>
                    {% for col in users[0].keys() %}
                        <th>{{ col }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in users %}
                <tr>
                    <td>{{ row["User ID"] }}</td>
                    <td><input type="text" value="{{ row['Username'] }}" disabled></td>
                    <td><input type="text" value="{{ row['Password'] }}" disabled></td>
                    <td>
                        <select disabled>
                            <option value="admin" {% if row['Role'] == "admin" %}selected{% endif %}>Admin</option>
                            <option value="reviewer_one" {% if row['Role'] == "reviewer_one" %}selected{% endif %}>Reviewer One</option>
                            <option value="reviewer_two" {% if row['Role'] == "reviewer_two" %}selected{% endif %}>Reviewer Two</option>
                        </select>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="no-data">No records found.</p>
        {% endif %}
    </div>
</div>

</body>
</html>
